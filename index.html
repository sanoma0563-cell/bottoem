<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>無料登録ページ</title>

<style>
body {
  margin: 0;
  background: #f7f7f7;
  font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Noto Sans JP", sans-serif;
}
.main-wrap {
  max-width: 540px;
  margin: 0 auto;
  background: #fff;
}
.hero-img {
  width: 100%;
  display: block;
}
.form-box {
  padding: 22px;
}
.title {
  font-size: 20px;
  font-weight: bold;
  text-align: center;
  margin-bottom: 14px;
}
input[type="email"] {
  width: 100%;
  padding: 16px;
  font-size: 16px;
  border-radius: 10px;
  border: 1px solid #ccc;
  margin-bottom: 16px;
}
.submit-btn {
  width: 100%;
  padding: 18px;
  background: linear-gradient(180deg, #8ad53c, #6cb428);
  color: #fff;
  border: none;
  border-radius: 100px;
  font-size: 20px;
  font-weight: bold;
  cursor: pointer;
}
.submit-btn:disabled {
  opacity: 0.6;
}
.msg {
  text-align: center;
  margin-top: 12px;
  font-size: 15px;
}
</style>
</head>

<body>

<div class="main-wrap">
  <img src="https://sanoma0563-cell.github.io/bottoem/Travel.png" class="hero-img" alt="広告">

  <div class="form-box">
    <div class="title">▼ メールアドレスを入力して参加 ▼</div>

    <form id="leadForm" novalidate>
      <input
        id="email"
        type="email"
        name="email"
        placeholder="例：sample@gmail.com"
        required
      >
      <button id="submitBtn" type="submit" class="submit-btn">
        参加する
      </button>
      <p id="msg" class="msg"></p>
    </form>
  </div>
</div>

<script>
const form = document.getElementById("leadForm");
const emailInput = document.getElementById("email");
const btn = document.getElementById("submitBtn");
const msg = document.getElementById("msg");

/*
 ★★★ ここだけ必ず自分の Formspree Endpoint に変更 ★★★
 例：https://formspree.io/f/mabcdxyz
*/
const FORMSPREE_URL = "https://formspree.io/f/xaqwlarj";

form.addEventListener("submit", async (e) => {
  e.preventDefault();
  msg.textContent = "";
  msg.style.color = "";

  const email = emailInput.value.trim();
  const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

  // メールアドレスチェック
  if (!re.test(email)) {
    msg.textContent = "正しいメールアドレスを入力してください";
    msg.style.color = "#c33";
    return;
  }

  // 二重送信防止
  btn.disabled = true;
  btn.textContent = "送信中…";

  try {
    const res = await fetch(FORMSPREE_URL, {
      method: "POST",
      headers: {
        "Accept": "application/json",
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        email: email
      })
    });

    if (res.ok) {
      msg.textContent = "登録完了！ありがとうございます";
      msg.style.color = "green";

      // 成功後の遷移先
      setTimeout(() => {
        location.href = "https://sanoconsultingengineers.jimdofree.com/";
      }, 900);

    } else {
      msg.textContent = "送信に失敗しました。時間をおいて再度お試しください。";
      msg.style.color = "#c33";
      btn.disabled = false;
      btn.textContent = "参加する";
    }

  } catch (err) {
    msg.textContent = "通信エラーが発生しました。ネット環境をご確認ください。";
    msg.style.color = "#c33";
    btn.disabled = false;
    btn.textContent = "参加する";
  }
});
</script>

</body>
</html>
